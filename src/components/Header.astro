---
// Header con Navbar y Slider para sitio de cabañas
import { Image } from "astro:assets";
import headerCabana from "../assets/headerCabana.webp";
import headerHabitacion from "../assets/headerHabhitacion.webp";
import headerPileta from "../assets/headerPileta.webp";
import headerRustico from "../assets/headerRustico.webp";
---

<header class="relative">
  <!-- Navbar -->
  <nav
    class="fixed top-0 left-0 right-0 z-50 bg-neutral-50/95 backdrop-blur-sm shadow-md transition-all duration-300"
  >
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16 md:h-20">
        <!-- Logo -->
        <div class="flex items-center">
          <a
            href="/"
            class="text-2xl md:text-3xl font-bold text-accent-700 hover:text-primary-600 transition-colors"
          >
            Apapacho Colón
          </a>
        </div>

        <!-- Desktop Menu -->
        <div class="hidden md:flex items-center space-x-8">
          <a
            href="/#cabanas"
            class="text-accent-700 hover:text-primary-600 transition-colors font-medium"
            >Cabañas</a
          >
          <a
            href="/#servicios"
            class="text-accent-700 hover:text-primary-600 transition-colors font-medium"
            >Servicios</a
          >
          <a
            href="/galeria"
            class="text-accent-700 hover:text-primary-600 transition-colors font-medium"
            >Galería</a
          >
          <a
            href="/#contacto"
            class="text-accent-700 hover:text-primary-600 transition-colors font-medium"
            >Contacto</a
          >
          <a
            href="/#contacto"
            class="bg-primary-500 text-white px-6 py-2 rounded-full hover:bg-primary-600 transition-colors font-medium shadow-md"
          >
            Reservar
          </a>
        </div>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-button"
          class="md:hidden text-accent-700 hover:text-primary-600 focus:outline-none"
          aria-label="Abrir menú"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div
      id="mobile-menu"
      class="hidden md:hidden bg-neutral-50 border-t border-neutral-300"
    >
      <div class="px-4 pt-2 pb-4 space-y-2">
        <a
          href="/#cabanas"
          class="block px-3 py-2 text-accent-700 hover:bg-primary-50 hover:text-primary-600 rounded-lg transition-colors font-medium"
          >Cabañas</a
        >
        <a
          href="/#servicios"
          class="block px-3 py-2 text-accent-700 hover:bg-primary-50 hover:text-primary-600 rounded-lg transition-colors font-medium"
          >Servicios</a
        >
        <a
          href="/galeria"
          class="block px-3 py-2 text-accent-700 hover:bg-primary-50 hover:text-primary-600 rounded-lg transition-colors font-medium"
          >Galería</a
        >
        <a
          href="/#contacto"
          class="block px-3 py-2 text-accent-700 hover:bg-primary-50 hover:text-primary-600 rounded-lg transition-colors font-medium"
          >Contacto</a
        >
        <a
          href="/#contacto"
          class="block mx-3 mt-4 px-3 py-2 bg-primary-500 text-white text-center rounded-full hover:bg-primary-600 transition-colors font-medium shadow-md"
        >
          Reservar
        </a>
      </div>
    </div>
  </nav>

  <!-- Hero Slider -->
  <div
    class="relative h-[60vh] md:h-[70vh] lg:h-[80vh] overflow-hidden mt-16 md:mt-20"
  >
    <!-- Slides -->
    <div id="slider" class="relative w-full h-full">
      <!-- Slide 1 -->
      <div
        class="slider-item absolute inset-0 opacity-100 transition-opacity duration-1000 pointer-events-auto"
      >
        <Image
          src={headerCabana}
          alt="Cabaña rodeada de naturaleza"
          class="w-full h-full object-cover"
          widths={[800, 1200, 1920]}
          sizes="100vw"
        />
        <div class="absolute inset-0 bg-black/50"></div>
        <div
          class="absolute inset-0 flex items-center justify-center text-center px-4"
        >
          <div class="max-w-3xl">
            <h1
              class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4 drop-shadow-lg"
            >
              Tu Refugio en la Naturaleza
            </h1>
            <p class="text-lg md:text-xl text-white/90 mb-8 drop-shadow-md">
              Descubre la tranquilidad en nuestras cabañas rodeadas de naturaleza
            </p>
            <a
              href="/galeria"
              class="slide-cta inline-block bg-neutral-100 text-accent-700 px-8 py-3 rounded-full font-semibold hover:bg-primary-500 hover:text-white transition-colors shadow-lg"
              data-href="/galeria"
            >
              Ver Cabañas
            </a>
          </div>
        </div>
      </div>

      <!-- Slide 2 -->
      <div
        class="slider-item absolute inset-0 opacity-0 transition-opacity duration-1000 pointer-events-none"
      >
        <Image
          src={headerHabitacion}
          alt="Interior acogedor de habitación"
          class="w-full h-full object-cover"
          widths={[800, 1200, 1920]}
          sizes="100vw"
        />
        <div class="absolute inset-0 bg-black/50"></div>
        <div
          class="absolute inset-0 flex items-center justify-center text-center px-4"
        >
          <div class="max-w-3xl">
            <h1
              class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4 drop-shadow-lg"
            >
              Confort y Calidez
            </h1>
            <p class="text-lg md:text-xl text-white/90 mb-8 drop-shadow-md">
              Espacios diseñados para tu descanso y bienestar
            </p>
            <a
              href="/#servicios"
              class="slide-cta inline-block bg-neutral-100 text-accent-700 px-8 py-3 rounded-full font-semibold hover:bg-secondary-500 hover:text-white transition-colors shadow-lg"
              data-href="/#servicios"
            >
              Nuestros Servicios
            </a>
          </div>
        </div>
      </div>

      <!-- Slide 3 -->
      <div
        class="slider-item absolute inset-0 opacity-0 transition-opacity duration-1000 pointer-events-none"
      >
        <Image
          src={headerPileta}
          alt="Pileta y áreas de recreación"
          class="w-full h-full object-cover"
          widths={[800, 1200, 1920]}
          sizes="100vw"
        />
        <div class="absolute inset-0 bg-black/50"></div>
        <div
          class="absolute inset-0 flex items-center justify-center text-center px-4"
        >
          <div class="max-w-3xl">
            <h1
              class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4 drop-shadow-lg"
            >
              Relájate y Disfruta
            </h1>
            <p class="text-lg md:text-xl text-white/90 mb-8 drop-shadow-md">
              Pileta, parrilla y todas las comodidades para tu descanso
            </p>
            <a
              href="/#contacto"
              class="slide-cta inline-block bg-neutral-100 text-accent-700 px-8 py-3 rounded-full font-semibold hover:bg-accent-700 hover:text-white transition-colors shadow-lg"
              data-href="/#contacto"
            >
              Contáctanos
            </a>
          </div>
        </div>
      </div>

      <!-- Slide 4 -->
      <div
        class="slider-item absolute inset-0 opacity-0 transition-opacity duration-1000 pointer-events-none"
      >
        <Image
          src={headerRustico}
          alt="Ambiente rústico y acogedor"
          class="w-full h-full object-cover"
          widths={[800, 1200, 1920]}
          sizes="100vw"
        />
        <div class="absolute inset-0 bg-black/50"></div>
        <div
          class="absolute inset-0 flex items-center justify-center text-center px-4"
        >
          <div class="max-w-3xl">
            <h1
              class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4 drop-shadow-lg"
            >
              Experiencias Inolvidables
            </h1>
            <p class="text-lg md:text-xl text-white/90 mb-8 drop-shadow-md">
              Conecta con la naturaleza y descansa de la rutina
            </p>
            <a
              href="/#contacto"
              class="slide-cta inline-block bg-neutral-100 text-accent-700 px-8 py-3 rounded-full font-semibold hover:bg-accent-700 hover:text-white transition-colors shadow-lg"
              data-href="/#contacto"
            >
              Contáctanos
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Slider Controls -->
    <button
      id="prev-slide"
      class="hidden md:flex absolute left-4 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition-all z-10 backdrop-blur-sm"
      aria-label="Slide anterior"
    >
      <svg
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 19l-7-7 7-7"></path>
      </svg>
    </button>
    <button
      id="next-slide"
      class="hidden md:flex absolute right-4 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition-all z-10 backdrop-blur-sm"
      aria-label="Slide siguiente"
    >
      <svg
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 5l7 7-7 7"></path>
      </svg>
    </button>

    <!-- Slider Indicators -->
    <div
      class="absolute bottom-6 left-1/2 -translate-x-1/2 flex space-x-2 z-10"
    >
      <button
        class="slider-dot w-3 h-3 rounded-full bg-white opacity-100 transition-opacity"
        data-slide="0"
        aria-label="Ir a slide 1"></button>
      <button
        class="slider-dot w-3 h-3 rounded-full bg-white opacity-50 transition-opacity"
        data-slide="1"
        aria-label="Ir a slide 2"></button>
      <button
        class="slider-dot w-3 h-3 rounded-full bg-white opacity-50 transition-opacity"
        data-slide="2"
        aria-label="Ir a slide 3"></button>
      <button
        class="slider-dot w-3 h-3 rounded-full bg-white opacity-50 transition-opacity"
        data-slide="3"
        aria-label="Ir a slide 4"></button>
    </div>
  </div>
</header>

<script>
  // Mobile Menu Toggle
  const mobileMenuButton = document.getElementById("mobile-menu-button");
  const mobileMenu = document.getElementById("mobile-menu");

  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
    });

    // Cerrar menú al hacer clic en un enlace
    const mobileLinks = mobileMenu.querySelectorAll("a");
    mobileLinks.forEach((link) => {
      link.addEventListener("click", () => {
        mobileMenu.classList.add("hidden");
      });
    });
  }

  // Slider functionality
  let currentSlide = 0;
  const slides = document.querySelectorAll(".slider-item");
  const dots = document.querySelectorAll(".slider-dot");
  const totalSlides = slides.length;

  function showSlide(index: number) {
    // Asegurar que el índice esté dentro del rango
    currentSlide = (index + totalSlides) % totalSlides;

    // Actualizar slides
    slides.forEach((slide, i) => {
      if (i === currentSlide) {
        slide.classList.remove("opacity-0", "pointer-events-none");
        slide.classList.add("opacity-100", "pointer-events-auto");
      } else {
        slide.classList.remove("opacity-100", "pointer-events-auto");
        slide.classList.add("opacity-0", "pointer-events-none");
      }
    });

    // Actualizar dots
    dots.forEach((dot, i) => {
      if (i === currentSlide) {
        dot.classList.remove("opacity-50");
        dot.classList.add("opacity-100");
      } else {
        dot.classList.remove("opacity-100");
        dot.classList.add("opacity-50");
      }
    });
  }

  // Auto-play slider
  let autoplayInterval = setInterval(() => {
    showSlide(currentSlide + 1);
  }, 5000);

  // Función para reiniciar el autoplay
  function resetAutoplay() {
    clearInterval(autoplayInterval);
    autoplayInterval = setInterval(() => {
      showSlide(currentSlide + 1);
    }, 5000);
  }

  // Botones de navegación
  const prevButton = document.getElementById("prev-slide");
  const nextButton = document.getElementById("next-slide");

  if (prevButton) {
    prevButton.addEventListener("click", () => {
      showSlide(currentSlide - 1);
      resetAutoplay();
    });
  }

  if (nextButton) {
    nextButton.addEventListener("click", () => {
      showSlide(currentSlide + 1);
      resetAutoplay();
    });
  }

  // Dots de navegación
  dots.forEach((dot) => {
    dot.addEventListener("click", (e) => {
      const target = e.target as HTMLElement;
      const slideIndex = parseInt(target.getAttribute("data-slide") || "0");
      showSlide(slideIndex);
      resetAutoplay();
    });
  });

  // Pausar autoplay cuando el usuario interactúa
  const sliderContainer = document.getElementById("slider");
  if (sliderContainer) {
    sliderContainer.addEventListener("mouseenter", () => {
      clearInterval(autoplayInterval);
    });

    sliderContainer.addEventListener("mouseleave", () => {
      autoplayInterval = setInterval(() => {
        showSlide(currentSlide + 1);
      }, 5000);
    });
  }

  // Navegación con teclado
  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") {
      showSlide(currentSlide - 1);
      resetAutoplay();
    } else if (e.key === "ArrowRight") {
      showSlide(currentSlide + 1);
      resetAutoplay();
    }
  });
</script>
