---
import "../styles/global.css";
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Contacto from "../components/Contacto.astro";
import { Image } from "astro:assets";

// Importar imágenes de cabañas
import cabana1 from "../assets/galeria/cabaña/IMG_2079.webp";
import cabana2 from "../assets/galeria/cabaña/IMG_2082.webp";
import cabana3 from "../assets/galeria/cabaña/IMG_2087.webp";
import cabana4 from "../assets/galeria/cabaña/IMG_2088.webp";

// Importar imágenes de comodidades
import comodidad1 from "../assets/galeria/comodidades/IMG_2045_resultado.webp";
import comodidad2 from "../assets/galeria/comodidades/IMG_2046_resultado.webp";
import comodidad3 from "../assets/galeria/comodidades/IMG_2057_resultado.webp";
import comodidad4 from "../assets/galeria/comodidades/IMG_2061_resultado.webp";
import comodidad5 from "../assets/galeria/comodidades/IMG_2062_resultado.webp";
import comodidad6 from "../assets/galeria/comodidades/IMG_2063_resultado.webp";
import comodidad7 from "../assets/galeria/comodidades/IMG_2064_resultado.webp";
import comodidad8 from "../assets/galeria/comodidades/IMG_2066_resultado.webp";
import comodidad9 from "../assets/galeria/comodidades/IMG_2074_resultado.webp";
import comodidad10 from "../assets/galeria/comodidades/IMG_2076_resultado.webp";

// Galería de Cabañas
const cabanasImages = [
  {
    src: cabana1,
    alt: "Cabaña - Vista exterior",
  },
  {
    src: cabana2,
    alt: "Cabaña - Detalle arquitectónico",
  },
  {
    src: cabana3,
    alt: "Cabaña - Área común",
  },
  {
    src: cabana4,
    alt: "Cabaña - Interior",
  },
];

// Galería de Comodidades
const comodidadesImages = [
  {
    src: comodidad1,
    alt: "Instalaciones y servicios",
  },
  {
    src: comodidad2,
    alt: "Áreas de recreación",
  },
  {
    src: comodidad3,
    alt: "Espacios exteriores",
  },
  {
    src: comodidad4,
    alt: "Zona de descanso",
  },
  {
    src: comodidad5,
    alt: "Amenidades del complejo",
  },
  {
    src: comodidad6,
    alt: "Servicios disponibles",
  },
  {
    src: comodidad7,
    alt: "Áreas comunes",
  },
  {
    src: comodidad8,
    alt: "Instalaciones recreativas",
  },
  {
    src: comodidad9,
    alt: "Espacios de convivencia",
  },
  {
    src: comodidad10,
    alt: "Entorno y naturaleza",
  },
];
---

<Layout>
  <Header />

  <!-- Contenido principal -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Título General -->
    <div class="text-center mb-16">
      <h1 class="text-4xl md:text-5xl font-bold text-accent-700 mb-4">
        Galería de Fotos
      </h1>
      <p class="text-lg text-accent-800 max-w-2xl mx-auto">
        Descubre nuestras cabañas y todas las comodidades que ofrecemos
      </p>
    </div>

    <!-- Galería de Cabañas -->
    <section
      id="galeria-cabanas"
      class="mb-20"
      style="scroll-margin-top: 5rem;"
    >
      <h2 class="text-3xl md:text-4xl font-bold text-accent-700 mb-8">
        Cabañas
      </h2>

      <!-- Contenedor con ancho máximo -->
      <div class="max-w-4xl mx-auto">
        <!-- Slider Principal de Cabañas -->
        <div class="mb-6">
          <div id="gallery-cabanas-container" class="swiper gallery-cabanas-main relative rounded-lg overflow-hidden" style="aspect-ratio: 3/2;">
            <!-- Botón de pantalla completa -->
            <button
              class="fullscreen-btn-cabanas absolute top-4 right-4 z-20 bg-black/60 hover:bg-black/80 backdrop-blur-sm text-white p-2 rounded-lg transition-all"
              aria-label="Pantalla completa"
            >
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
              </svg>
            </button>
            
            <div class="swiper-wrapper">
            {
              cabanasImages.map((image) => (
                <div class="swiper-slide">
                  <Image
                    src={image.src}
                    alt={image.alt}
                    class="w-full h-full object-cover"
                    widths={[600, 900, 1200]}
                    sizes="(max-width: 768px) 100vw, 1200px"
                  />
                </div>
              ))
            }
          </div>
          <div class="swiper-button-next !hidden md:!flex"></div>
          <div class="swiper-button-prev !hidden md:!flex"></div>
          <div class="swiper-pagination"></div>
        </div>
      </div>

      <!-- Thumbnails de Cabañas -->
      <div class="swiper gallery-cabanas-thumbs">
        <div class="swiper-wrapper">
          {
            cabanasImages.map((image) => (
              <div class="swiper-slide cursor-pointer" style="aspect-ratio: 3/2;">
                <Image
                  src={image.src}
                  alt={image.alt}
                  class="w-full h-full object-cover rounded-lg"
                  widths={[150, 200]}
                  sizes="150px"
                />
              </div>
            ))
          }
        </div>
      </div>
      </div>
    </section>

    <!-- Galería de Comodidades -->
    <section
      id="galeria-comodidades"
      class="mb-20"
      style="scroll-margin-top: 5rem;"
    >
      <h2 class="text-3xl md:text-4xl font-bold text-accent-700 mb-8">
        Comodidades
      </h2>

      <!-- Contenedor con ancho máximo -->
      <div class="max-w-4xl mx-auto">
        <!-- Slider Principal de Comodidades -->
        <div class="mb-6">
          <div id="gallery-comodidades-container" class="swiper gallery-comodidades-main relative rounded-lg overflow-hidden" style="aspect-ratio: 3/2;">
            <!-- Botón de pantalla completa -->
            <button
              class="fullscreen-btn-comodidades absolute top-4 right-4 z-20 bg-black/60 hover:bg-black/80 backdrop-blur-sm text-white p-2 rounded-lg transition-all"
              aria-label="Pantalla completa"
            >
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
              </svg>
            </button>
            
            <div class="swiper-wrapper">
            {
              comodidadesImages.map((image) => (
                <div class="swiper-slide">
                  <Image
                    src={image.src}
                    alt={image.alt}
                    class="w-full h-full object-cover"
                    widths={[600, 900, 1200]}
                    sizes="(max-width: 768px) 100vw, 1200px"
                  />
                </div>
              ))
            }
          </div>
          <div class="swiper-button-next !hidden md:!flex"></div>
          <div class="swiper-button-prev !hidden md:!flex"></div>
          <div class="swiper-pagination"></div>
        </div>
      </div>

      <!-- Thumbnails de Comodidades -->
      <div class="swiper gallery-comodidades-thumbs">
        <div class="swiper-wrapper">
          {
            comodidadesImages.map((image) => (
              <div class="swiper-slide cursor-pointer" style="aspect-ratio: 3/2;">
                <Image
                  src={image.src}
                  alt={image.alt}
                  class="w-full h-full object-cover rounded-lg"
                  widths={[150, 200]}
                  sizes="150px"
                />
              </div>
            ))
          }
        </div>
      </div>
      </div>
    </section>

    <!-- Sección de Contacto -->
    <Contacto />
  </main>

  <!-- Footer -->
  <footer class="text-white py-8" style="background-color: #4d3124;">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <p>&copy; 2025 Apapacho Colón. Todos los derechos reservados.</p>
    </div>
  </footer>
</Layout>

<style>
  /* Importar estilos de Swiper */
  @import "swiper/css";
  @import "swiper/css/navigation";
  @import "swiper/css/pagination";
  @import "swiper/css/thumbs";

  /* Personalizar botones de navegación */
  :global(.swiper-button-next),
  :global(.swiper-button-prev) {
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(4px);
    width: 36px;
    height: 36px;
    border-radius: 50%;
    transition: all 0.2s ease;
    color: transparent !important;
  }

  :global(.swiper-button-next:after),
  :global(.swiper-button-prev:after) {
    display: none;
  }

  :global(.swiper-button-next),
  :global(.swiper-button-prev) {
    background-size: 16px 16px;
    background-repeat: no-repeat;
    background-position: center;
  }

  :global(.swiper-button-next) {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white' stroke-width='3'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M9 5l7 7-7 7'/%3E%3C/svg%3E");
  }

  :global(.swiper-button-prev) {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white' stroke-width='3'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M15 19l-7-7 7-7'/%3E%3C/svg%3E");
  }

  :global(.swiper-button-next:hover),
  :global(.swiper-button-prev:hover) {
    background-color: rgba(0, 0, 0, 0.5);
    transform: scale(1.05);
  }

  /* Personalizar paginación */
  :global(.swiper-pagination-bullet) {
    background: #fff;
    opacity: 0.7;
    width: 10px;
    height: 10px;
  }

  :global(.swiper-pagination-bullet-active) {
    background: #fff;
    opacity: 1;
    width: 24px;
    border-radius: 5px;
  }

  /* Thumbnails por defecto - solo aplica a las miniaturas */
  :global(.gallery-cabanas-thumbs .swiper-slide img),
  :global(.gallery-comodidades-thumbs .swiper-slide img) {
    opacity: 0.6;
    transition: opacity 0.3s ease;
  }

  :global(.gallery-cabanas-thumbs .swiper-slide:hover img),
  :global(.gallery-comodidades-thumbs .swiper-slide:hover img) {
    opacity: 1;
  }

  /* Estilo para thumbnails activos - sin filtro */
  :global(.swiper-slide-thumb-active) {
    opacity: 1 !important;
  }

  :global(.swiper-slide-thumb-active img) {
    opacity: 1 !important;
    border: 3px solid #d97706;
    border-radius: 0.5rem;
  }

  /* Asegurar que las imágenes principales siempre tengan opacidad completa */
  :global(.gallery-cabanas-main .swiper-slide img),
  :global(.gallery-comodidades-main .swiper-slide img) {
    opacity: 1 !important;
  }

  /* Prevenir selección de imágenes y texto en el slider */
  :global(.gallery-cabanas-main),
  :global(.gallery-comodidades-main) {
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
  }

  :global(.gallery-cabanas-main .swiper-slide img),
  :global(.gallery-comodidades-main .swiper-slide img) {
    pointer-events: none;
    -webkit-user-drag: none;
    user-drag: none;
  }

  /* Estilos para pantalla completa */
  :global(#gallery-cabanas-container:fullscreen),
  :global(#gallery-comodidades-container:fullscreen) {
    background: #000;
    padding: 1rem;
    aspect-ratio: auto !important;
    height: 100vh;
  }

  :global(#gallery-cabanas-container:fullscreen .swiper),
  :global(#gallery-comodidades-container:fullscreen .swiper) {
    height: 100%;
    width: 100%;
  }

  :global(#gallery-cabanas-container:fullscreen .swiper-wrapper),
  :global(#gallery-comodidades-container:fullscreen .swiper-wrapper) {
    align-items: center;
  }

  :global(#gallery-cabanas-container:fullscreen .swiper-slide),
  :global(#gallery-comodidades-container:fullscreen .swiper-slide) {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 80vw !important;
    opacity: 0.4;
    transition: opacity 0.3s ease;
  }

  :global(#gallery-cabanas-container:fullscreen .swiper-slide-active),
  :global(#gallery-comodidades-container:fullscreen .swiper-slide-active) {
    opacity: 1;
  }

  :global(#gallery-cabanas-container:fullscreen .swiper-slide-prev),
  :global(#gallery-cabanas-container:fullscreen .swiper-slide-next),
  :global(#gallery-comodidades-container:fullscreen .swiper-slide-prev),
  :global(#gallery-comodidades-container:fullscreen .swiper-slide-next) {
    opacity: 0.6;
  }

  :global(#gallery-cabanas-container:fullscreen .swiper-slide img),
  :global(#gallery-comodidades-container:fullscreen .swiper-slide img) {
    object-fit: contain !important;
    max-height: 85vh;
    max-width: 75vw;
    width: auto !important;
    height: auto !important;
  }

  /* Ajuste para desktop en pantalla completa */
  @media (min-width: 768px) {
    :global(#gallery-cabanas-container:fullscreen),
    :global(#gallery-comodidades-container:fullscreen) {
      padding: 2rem;
    }

    :global(#gallery-cabanas-container:fullscreen .swiper-slide img),
    :global(#gallery-comodidades-container:fullscreen .swiper-slide img) {
      max-width: 80vw;
    }
  }

  /* Ocultar thumbnails en pantalla completa */
  :global(#gallery-cabanas-container:fullscreen) ~ .gallery-cabanas-thumbs,
  :global(#gallery-comodidades-container:fullscreen) ~ .gallery-comodidades-thumbs {
    display: none;
  }

  /* Cambiar icono del botón en pantalla completa */
  .fullscreen-btn-cabanas.fullscreen-active svg,
  .fullscreen-btn-comodidades.fullscreen-active svg {
    transform: rotate(45deg);
  }
</style>

<script>
  import Swiper from "swiper";
  import { Navigation, Pagination, Thumbs } from "swiper/modules";

  // ========== GALERÍA DE CABAÑAS ==========
  const cabanasGalleryThumbs = new Swiper(".gallery-cabanas-thumbs", {
    spaceBetween: 10,
    slidesPerView: 4,
    freeMode: true,
    watchSlidesProgress: true,
    breakpoints: {
      640: {
        slidesPerView: 6,
      },
      768: {
        slidesPerView: 8,
      },
      1024: {
        slidesPerView: 10,
      },
    },
  });

  const cabanasMainSwiper = new Swiper(".gallery-cabanas-main", {
    modules: [Navigation, Pagination, Thumbs],
    spaceBetween: 10,
    slidesPerView: 1,
    centeredSlides: true,
    navigation: {
      nextEl: ".gallery-cabanas-main .swiper-button-next",
      prevEl: ".gallery-cabanas-main .swiper-button-prev",
    },
    pagination: {
      el: ".gallery-cabanas-main .swiper-pagination",
      clickable: true,
      dynamicBullets: true,
    },
    thumbs: {
      swiper: cabanasGalleryThumbs,
    },
    keyboard: {
      enabled: true,
    },
    loop: false,
  });

  // Funcionalidad de pantalla completa para Cabañas
  const fullscreenBtnCabanas = document.querySelector(".fullscreen-btn-cabanas");
  const galleryContainerCabanas = document.getElementById("gallery-cabanas-container");

  if (fullscreenBtnCabanas && galleryContainerCabanas) {
    fullscreenBtnCabanas.addEventListener("click", () => {
      if (!document.fullscreenElement) {
        galleryContainerCabanas.requestFullscreen().catch((err) => {
          console.error("Error al entrar en pantalla completa:", err);
        });
      } else {
        document.exitFullscreen();
      }
    });

    document.addEventListener("fullscreenchange", () => {
      if (document.fullscreenElement === galleryContainerCabanas) {
        fullscreenBtnCabanas.classList.add("fullscreen-active");
        cabanasMainSwiper.params.slidesPerView = "auto";
        cabanasMainSwiper.params.spaceBetween = 30;
        cabanasMainSwiper.params.centeredSlides = true;
        cabanasMainSwiper.update();
      } else if (!document.fullscreenElement) {
        fullscreenBtnCabanas.classList.remove("fullscreen-active");
        cabanasMainSwiper.params.slidesPerView = 1;
        cabanasMainSwiper.params.spaceBetween = 10;
        cabanasMainSwiper.params.centeredSlides = true;
        cabanasMainSwiper.update();
      }
    });
  }

  // ========== GALERÍA DE COMODIDADES ==========
  const comodidadesGalleryThumbs = new Swiper(".gallery-comodidades-thumbs", {
    spaceBetween: 10,
    slidesPerView: 4,
    freeMode: true,
    watchSlidesProgress: true,
    breakpoints: {
      640: {
        slidesPerView: 6,
      },
      768: {
        slidesPerView: 8,
      },
      1024: {
        slidesPerView: 10,
      },
    },
  });

  const comodidadesMainSwiper = new Swiper(".gallery-comodidades-main", {
    modules: [Navigation, Pagination, Thumbs],
    spaceBetween: 10,
    slidesPerView: 1,
    centeredSlides: true,
    navigation: {
      nextEl: ".gallery-comodidades-main .swiper-button-next",
      prevEl: ".gallery-comodidades-main .swiper-button-prev",
    },
    pagination: {
      el: ".gallery-comodidades-main .swiper-pagination",
      clickable: true,
      dynamicBullets: true,
    },
    thumbs: {
      swiper: comodidadesGalleryThumbs,
    },
    keyboard: {
      enabled: true,
    },
    loop: false,
  });

  // Funcionalidad de pantalla completa para Comodidades
  const fullscreenBtnComodidades = document.querySelector(".fullscreen-btn-comodidades");
  const galleryContainerComodidades = document.getElementById("gallery-comodidades-container");

  if (fullscreenBtnComodidades && galleryContainerComodidades) {
    fullscreenBtnComodidades.addEventListener("click", () => {
      if (!document.fullscreenElement) {
        galleryContainerComodidades.requestFullscreen().catch((err) => {
          console.error("Error al entrar en pantalla completa:", err);
        });
      } else {
        document.exitFullscreen();
      }
    });

    document.addEventListener("fullscreenchange", () => {
      if (document.fullscreenElement === galleryContainerComodidades) {
        fullscreenBtnComodidades.classList.add("fullscreen-active");
        comodidadesMainSwiper.params.slidesPerView = "auto";
        comodidadesMainSwiper.params.spaceBetween = 30;
        comodidadesMainSwiper.params.centeredSlides = true;
        comodidadesMainSwiper.update();
      } else if (!document.fullscreenElement) {
        fullscreenBtnComodidades.classList.remove("fullscreen-active");
        comodidadesMainSwiper.params.slidesPerView = 1;
        comodidadesMainSwiper.params.spaceBetween = 10;
        comodidadesMainSwiper.params.centeredSlides = true;
        comodidadesMainSwiper.update();
      }
    });
  }

  // Permitir salir de pantalla completa con ESC
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && document.fullscreenElement) {
      document.exitFullscreen();
    }
  });
</script>